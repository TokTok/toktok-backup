{
    "active_lock_reason": null,
    "assignee": null,
    "assignees": [],
    "author_association": "NONE",
    "body": "The ctest suite has never been run under a proxy. Could you add  SOCKS_HOST_TEST and SOCKS_PORT_TEST for testing in auto_tests/auto_test_support.c - should be straightforward.\r\n\r\n(And rename USE_IPV6 to USE_IPV6_TESTS while you're in there.)",
    "closed_at": null,
    "closed_by": null,
    "comment_data": [
        {
            "author_association": "NONE",
            "body": "Settable from CMakeCache.txt would be nice so you don't have to recompile the library, or is that defacto already the case?",
            "created_at": "2023-12-14T16:48:56Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2469#issuecomment-1856195083",
            "id": 1856195083,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469",
            "node_id": "IC_kwDOA7zIGs5uo0oL",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1856195083/reactions"
            },
            "updated_at": "2023-12-14T16:48:56Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1856195083",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/109981937?v=4",
                "events_url": "https://api.github.com/users/emdee-is/events{/privacy}",
                "followers_url": "https://api.github.com/users/emdee-is/followers",
                "following_url": "https://api.github.com/users/emdee-is/following{/other_user}",
                "gists_url": "https://api.github.com/users/emdee-is/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/emdee-is",
                "id": 109981937,
                "login": "emdee-is",
                "node_id": "U_kgDOBo4w8Q",
                "organizations_url": "https://api.github.com/users/emdee-is/orgs",
                "received_events_url": "https://api.github.com/users/emdee-is/received_events",
                "repos_url": "https://api.github.com/users/emdee-is/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/emdee-is/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/emdee-is/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/emdee-is",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "there needs to be another way. There is a proxy specific test, that tests the proxy functionality. If you think it is missing coverage, that test should be expanded instead.",
            "created_at": "2023-12-16T11:05:27Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2469#issuecomment-1858790823",
            "id": 1858790823,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469",
            "node_id": "IC_kwDOA7zIGs5uyuWn",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1858790823/reactions"
            },
            "updated_at": "2023-12-16T11:05:27Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1858790823",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2938071?v=4",
                "events_url": "https://api.github.com/users/Green-Sky/events{/privacy}",
                "followers_url": "https://api.github.com/users/Green-Sky/followers",
                "following_url": "https://api.github.com/users/Green-Sky/following{/other_user}",
                "gists_url": "https://api.github.com/users/Green-Sky/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Green-Sky",
                "id": 2938071,
                "login": "Green-Sky",
                "node_id": "MDQ6VXNlcjI5MzgwNzE=",
                "organizations_url": "https://api.github.com/users/Green-Sky/orgs",
                "received_events_url": "https://api.github.com/users/Green-Sky/received_events",
                "repos_url": "https://api.github.com/users/Green-Sky/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Green-Sky/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Green-Sky/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Green-Sky",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Can you point me to the \"proxy specific test, that tests the proxy functionality.\"? if it does what I'm asking here, I'll close this issue, but I can't see anything real in being in the ctests if it doesn't have a proxy server running during the tests.\r\n\r\nI think you're right: there needs to be another way. Turns out there is and iphy showed me how to spin up a VM with ipv6.disable=1 in Docker and then run tests using in Docker under qemu. But there is work to be done get apt to use the proxy.\r\n\r\nI tried to pull things altogeter on https://github.com/TokTok/c-toxcore/issues/2473",
            "created_at": "2023-12-16T15:14:53Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2469#issuecomment-1858840925",
            "id": 1858840925,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469",
            "node_id": "IC_kwDOA7zIGs5uy6ld",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1858840925/reactions"
            },
            "updated_at": "2023-12-16T15:14:53Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1858840925",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/109981937?v=4",
                "events_url": "https://api.github.com/users/emdee-is/events{/privacy}",
                "followers_url": "https://api.github.com/users/emdee-is/followers",
                "following_url": "https://api.github.com/users/emdee-is/following{/other_user}",
                "gists_url": "https://api.github.com/users/emdee-is/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/emdee-is",
                "id": 109981937,
                "login": "emdee-is",
                "node_id": "U_kgDOBo4w8Q",
                "organizations_url": "https://api.github.com/users/emdee-is/orgs",
                "received_events_url": "https://api.github.com/users/emdee-is/received_events",
                "repos_url": "https://api.github.com/users/emdee-is/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/emdee-is/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/emdee-is/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/emdee-is",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "https://github.com/TokTok/c-toxcore/blob/master/auto_tests/proxy_test.c\r\n\r\ndoes not look exhaustive, but it is there.\r\n\r\nedit: this explains why it is not run on your machine:\r\nhttps://github.com/TokTok/c-toxcore/blob/24b54722aed65b02f1e921f08f8d31d68f92a45a/CMakeLists.txt#L125-L128",
            "created_at": "2023-12-16T17:22:41Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2469#issuecomment-1858875998",
            "id": 1858875998,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469",
            "node_id": "IC_kwDOA7zIGs5uzDJe",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1858875998/reactions"
            },
            "updated_at": "2023-12-16T17:25:16Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1858875998",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2938071?v=4",
                "events_url": "https://api.github.com/users/Green-Sky/events{/privacy}",
                "followers_url": "https://api.github.com/users/Green-Sky/followers",
                "following_url": "https://api.github.com/users/Green-Sky/following{/other_user}",
                "gists_url": "https://api.github.com/users/Green-Sky/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Green-Sky",
                "id": 2938071,
                "login": "Green-Sky",
                "node_id": "MDQ6VXNlcjI5MzgwNzE=",
                "organizations_url": "https://api.github.com/users/Green-Sky/orgs",
                "received_events_url": "https://api.github.com/users/Green-Sky/received_events",
                "repos_url": "https://api.github.com/users/Green-Sky/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Green-Sky/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Green-Sky/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Green-Sky",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Thanks - I've run it in the past, but came to the conclusion that a single call to tox_add_tcp_relay is a test of whether that call works and that's it. I don't think that is a test of whether the program connected to the network and the proxy works.\r\n\r\nIn real life I find that tox_add_tcp_relay always returns true, even if the SOCKS proxy is not connected to the internet (wifi down). My toxygen code randomly picks 6 BS nodes and tox_add_tcp_relay them all, and then checks dht_connected, repeated every 5? seconds for up to 120? seconds. It's very rare to get the dht_connected in less than 30 seconds, more normal would be 45.\r\n\r\nCheck what tox_add_tcp_relay and if it ever fails, but AFAIK this is a test of minimal use. The testing case over SOCKS gets harder for things like group_join; there on a fresh group, it's more like 45 minutes, and more likely to have a code failure than tox_add_tcp_relay as it changes often.",
            "created_at": "2023-12-16T23:00:52Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2469#issuecomment-1858975595",
            "id": 1858975595,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469",
            "node_id": "IC_kwDOA7zIGs5uzbdr",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1858975595/reactions"
            },
            "updated_at": "2023-12-16T23:00:52Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1858975595",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/109981937?v=4",
                "events_url": "https://api.github.com/users/emdee-is/events{/privacy}",
                "followers_url": "https://api.github.com/users/emdee-is/followers",
                "following_url": "https://api.github.com/users/emdee-is/following{/other_user}",
                "gists_url": "https://api.github.com/users/emdee-is/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/emdee-is",
                "id": 109981937,
                "login": "emdee-is",
                "node_id": "U_kgDOBo4w8Q",
                "organizations_url": "https://api.github.com/users/emdee-is/orgs",
                "received_events_url": "https://api.github.com/users/emdee-is/received_events",
                "repos_url": "https://api.github.com/users/emdee-is/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/emdee-is/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/emdee-is/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/emdee-is",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "While you're doing the socks flags, -DUSE_UDP_TEST should be added too, to make sure it's not evading tcp.",
            "created_at": "2023-12-16T23:02:47Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2469#issuecomment-1858977852",
            "id": 1858977852,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469",
            "node_id": "IC_kwDOA7zIGs5uzcA8",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1858977852/reactions"
            },
            "updated_at": "2023-12-16T23:02:47Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1858977852",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/109981937?v=4",
                "events_url": "https://api.github.com/users/emdee-is/events{/privacy}",
                "followers_url": "https://api.github.com/users/emdee-is/followers",
                "following_url": "https://api.github.com/users/emdee-is/following{/other_user}",
                "gists_url": "https://api.github.com/users/emdee-is/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/emdee-is",
                "id": 109981937,
                "login": "emdee-is",
                "node_id": "U_kgDOBo4w8Q",
                "organizations_url": "https://api.github.com/users/emdee-is/orgs",
                "received_events_url": "https://api.github.com/users/emdee-is/received_events",
                "repos_url": "https://api.github.com/users/emdee-is/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/emdee-is/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/emdee-is/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/emdee-is",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "Regarding https://github.com/TokTok/c-toxcore/blob/master/auto_tests/proxy_test.c I wrote in https://github.com/TokTok/c-toxcore/issues/2469#issuecomment-1858975595\r\n> but came to the conclusion that a single call to tox_add_tcp_relay is a test of whether that call works and that's it. I don't think that is a test of whether the program connected to the network and the proxy works.\r\n\r\nLooking at the code to tox_add_tcp_relay in tox.c, as long as the relay host resolves, it doesn't even look for failure from add_tcp_relay: \r\n```\r\n        add_tcp_relay(tox->m->net_crypto, &root[i], public_key);\r\n```\r\nwhich is what I see in practice.\r\n\r\nIn the testsuite case it will never fail because the nodes it tests against are on localhost, which will always resolve. In other words, Tox's test of a tcp SOCKS proxy will always pass.\r\n\r\nPS: Dear Santa: A version of add_tcp_relay that loops through a set of tcp nodes and loops until dht_connected is true is very high on my wish list.",
            "created_at": "2023-12-16T23:35:59Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2469#issuecomment-1858986719",
            "id": 1858986719,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469",
            "node_id": "IC_kwDOA7zIGs5uzeLf",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1858986719/reactions"
            },
            "updated_at": "2024-02-01T21:53:53Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1858986719",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/109981937?v=4",
                "events_url": "https://api.github.com/users/emdee-is/events{/privacy}",
                "followers_url": "https://api.github.com/users/emdee-is/followers",
                "following_url": "https://api.github.com/users/emdee-is/following{/other_user}",
                "gists_url": "https://api.github.com/users/emdee-is/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/emdee-is",
                "id": 109981937,
                "login": "emdee-is",
                "node_id": "U_kgDOBo4w8Q",
                "organizations_url": "https://api.github.com/users/emdee-is/orgs",
                "received_events_url": "https://api.github.com/users/emdee-is/received_events",
                "repos_url": "https://api.github.com/users/emdee-is/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/emdee-is/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/emdee-is/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/emdee-is",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "@Green-Sky ~~now that the IPV6 problem has been fixed (thanks), I can see that the one-and-only proxy ctest never tests Tox behind a firewalling proxy and the one-and-only proxy ctest test always fails. It has to fail: it starts a socks proxy written in go that is behind a firewall with no information on the outside-of-ctesrt proxy IP:port. So there is no testing of a proxy in Tox that's firewalled - at all.~~ Note that Tox does not yet support corporate proxies https://github.com/TokTok/c-toxcore/issues/1682  \r\n\r\nThere's a blindspot in the project by relying on ctest. If the project supported Python bindings https://github.com/TokTok/py-toxcore-c/issues/78#issuecomment-1920417914  then it would be easier to use a proxy-aware testrunner written in Python: https://git.plastiras.org/emdee/toxygen_wrapper/src/branch/main/src/tox_wrapper/tests/tests_wrapper.py",
            "created_at": "2024-02-04T21:14:10Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2469#issuecomment-1925916136",
            "id": 1925916136,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469",
            "node_id": "IC_kwDOA7zIGs5yyyXo",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1925916136/reactions"
            },
            "updated_at": "2024-02-06T07:30:42Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1925916136",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/109981937?v=4",
                "events_url": "https://api.github.com/users/emdee-is/events{/privacy}",
                "followers_url": "https://api.github.com/users/emdee-is/followers",
                "following_url": "https://api.github.com/users/emdee-is/following{/other_user}",
                "gists_url": "https://api.github.com/users/emdee-is/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/emdee-is",
                "id": 109981937,
                "login": "emdee-is",
                "node_id": "U_kgDOBo4w8Q",
                "organizations_url": "https://api.github.com/users/emdee-is/orgs",
                "received_events_url": "https://api.github.com/users/emdee-is/received_events",
                "repos_url": "https://api.github.com/users/emdee-is/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/emdee-is/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/emdee-is/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/emdee-is",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "\"proxy behind a firewall\" - can you explain what that even means?\r\n\r\nthe proxy test requires the test-proxy executable as parameter, which is started as an extra thread and provides both http and socks5 for the localhost test.\r\n\r\nthe get back the the \"firewalled\" point, no where here should any traffic leave the system. (they dont bootstrap off the internet, but agains each other).\r\n\r\nalso worth mentioning: the cmake/ctest proxy test does not work, as it does not supply the needed proxy executable as cli argument. https://github.com/TokTok/c-toxcore/blob/e202341e76a67f3773e83966d6837de881c66357/auto_tests/BUILD.bazel#L32-L34",
            "created_at": "2024-02-04T21:40:38Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2469#issuecomment-1925930445",
            "id": 1925930445,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469",
            "node_id": "IC_kwDOA7zIGs5yy13N",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1925930445/reactions"
            },
            "updated_at": "2024-02-04T21:40:38Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1925930445",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2938071?v=4",
                "events_url": "https://api.github.com/users/Green-Sky/events{/privacy}",
                "followers_url": "https://api.github.com/users/Green-Sky/followers",
                "following_url": "https://api.github.com/users/Green-Sky/following{/other_user}",
                "gists_url": "https://api.github.com/users/Green-Sky/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Green-Sky",
                "id": 2938071,
                "login": "Green-Sky",
                "node_id": "MDQ6VXNlcjI5MzgwNzE=",
                "organizations_url": "https://api.github.com/users/Green-Sky/orgs",
                "received_events_url": "https://api.github.com/users/Green-Sky/received_events",
                "repos_url": "https://api.github.com/users/Green-Sky/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Green-Sky/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Green-Sky/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Green-Sky",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "> \"proxy behind a firewall\" - can you explain what that even means?\r\n\r\nI run a Tor proxy and I also run firewall rules that's what I call \"proxy behind a firewall\" . I could run a proxy without a firewall. ~~The  proxy test assumes there is no firewall.~~\r\n\r\n> the proxy test requires the test-proxy executable as parameter, which is started as an extra thread and provides both http and socks5 for the localhost test.\r\n\r\nI could run the proxy test without being behind a firewall.\r\n\r\n> the get back the the \"firewalled\" point, no where here should any traffic leave the system. (they dont bootstrap off the internet, but agains each other).\r\n\r\n~~The  proxy test assumes there is _no firewall against the proxy.~~\r\n\r\n> also worth mentioning: the cmake/ctest proxy test does not work, as it does not supply the needed proxy executable as cli argument.\r\n\r\nI missed that. But if you look in the Dockerfiles I think I saw it compiling a SOCKS proxy written in go and uses that. ~~But that still assumes there is _no firewall against the proxy._ So it may work in a CI setup, and fail in the ctesting I was talking about which is me testing the \"proxy test behind a firewall\".~~\r\n\r\nOf course  it is an expected failure as I didn't provide it with the go compiled proxy :-,( so I'll go back to disabling that test, or provide it that proxy.\r\n\r\nSo back to the original feature request: my theory is that if we add -DSOCKS_HOST_TEST and -DSOCKS_PORT_TEST for testing\r\nto the ToxOptions then the tests would run over the SOCKS proxy.\r\nThen we could get the results of all of the ctests \"behind a firewall\".",
            "created_at": "2024-02-04T22:40:21Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2469#issuecomment-1925950794",
            "id": 1925950794,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469",
            "node_id": "IC_kwDOA7zIGs5yy61K",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1925950794/reactions"
            },
            "updated_at": "2024-02-06T07:32:58Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1925950794",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/109981937?v=4",
                "events_url": "https://api.github.com/users/emdee-is/events{/privacy}",
                "followers_url": "https://api.github.com/users/emdee-is/followers",
                "following_url": "https://api.github.com/users/emdee-is/following{/other_user}",
                "gists_url": "https://api.github.com/users/emdee-is/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/emdee-is",
                "id": 109981937,
                "login": "emdee-is",
                "node_id": "U_kgDOBo4w8Q",
                "organizations_url": "https://api.github.com/users/emdee-is/orgs",
                "received_events_url": "https://api.github.com/users/emdee-is/received_events",
                "repos_url": "https://api.github.com/users/emdee-is/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/emdee-is/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/emdee-is/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/emdee-is",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "I don't get it. A firewall is setup at a network boundary. But the proxy test has no network boundaries, so a firewall would not come close the any traffic happening at the testcase...\r\n\r\nthe proxy test sets up tox1, which has udp and tcp enabled (not bootstrapped)\r\ntox2 is also a \"regular\" node with udp and tcp enabled. It is bootstrapped off of tox1.\r\ntox3 is tcp only and uses the http proxy to bootstrap off of tox1.\r\ntox4 is the same as tox3 but using the socks proxy.\r\n\r\neverything is happening localhost, how would a firewall _against_ a proxy work here? and what would it do?",
            "created_at": "2024-02-04T23:53:16Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2469#issuecomment-1925993227",
            "id": 1925993227,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469",
            "node_id": "IC_kwDOA7zIGs5yzFML",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1925993227/reactions"
            },
            "updated_at": "2024-02-04T23:53:25Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1925993227",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2938071?v=4",
                "events_url": "https://api.github.com/users/Green-Sky/events{/privacy}",
                "followers_url": "https://api.github.com/users/Green-Sky/followers",
                "following_url": "https://api.github.com/users/Green-Sky/following{/other_user}",
                "gists_url": "https://api.github.com/users/Green-Sky/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Green-Sky",
                "id": 2938071,
                "login": "Green-Sky",
                "node_id": "MDQ6VXNlcjI5MzgwNzE=",
                "organizations_url": "https://api.github.com/users/Green-Sky/orgs",
                "received_events_url": "https://api.github.com/users/Green-Sky/received_events",
                "repos_url": "https://api.github.com/users/Green-Sky/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Green-Sky/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Green-Sky/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Green-Sky",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "> everything is happening localhost, how would a firewall against a proxy work here? and what would it do?\r\n\r\nFor the proxy ctest you're right, I'll dig into the failure I'm getting and get the go proxy compiled.\r\n\r\nFor the other tests; there are firewall rules in place such that nothing is coming in and only SOCKS to 9050 is going out (DNS to 9053 only).\r\n\r\nNo problem up to test 50. then:\r\n```\r\nThe following tests FAILED:\r\n         51 - bootstrap (Timeout)\r\n         52 - tcp_relay (Timeout)\r\n```\r\nThese will fail until you wire me up the changes for -DSOCKS_HOST_TEST and -DSOCKS_PORT_TEST for testng. Then the tests would run over the Tor proxy. Then we could get the results of all of the ctests \"behind a firewall\"  over Tor.\r\n",
            "created_at": "2024-02-05T00:26:34Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2469#issuecomment-1926012454",
            "id": 1926012454,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469",
            "node_id": "IC_kwDOA7zIGs5yzJ4m",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1926012454/reactions"
            },
            "updated_at": "2024-02-05T04:25:27Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1926012454",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/109981937?v=4",
                "events_url": "https://api.github.com/users/emdee-is/events{/privacy}",
                "followers_url": "https://api.github.com/users/emdee-is/followers",
                "following_url": "https://api.github.com/users/emdee-is/following{/other_user}",
                "gists_url": "https://api.github.com/users/emdee-is/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/emdee-is",
                "id": 109981937,
                "login": "emdee-is",
                "node_id": "U_kgDOBo4w8Q",
                "organizations_url": "https://api.github.com/users/emdee-is/orgs",
                "received_events_url": "https://api.github.com/users/emdee-is/received_events",
                "repos_url": "https://api.github.com/users/emdee-is/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/emdee-is/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/emdee-is/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/emdee-is",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "NONE",
            "body": "> there needs to be another way. There is a proxy specific test, that tests the proxy functionality. If you think it is missing coverage, that test should be expanded instead.\r\n\r\nPlease note that bootstrap and tcp_relay tests are the **only tests that use the network**. All the other ctests ate not testing real network-connected behaviour.\r\nTo confirm, turn off your wifi and run ctest, So the idea behind this feature request is to think deal with the missing coverage of those 2 ctests.  \r\n\r\nI personally think that all the testing should be expanded as well so that real across-the-network testing is done in real world conditions. But  that's better done in Python. If TokTok supported Python it could do a [proxy-aware testrunner](https://git.plastiras.org/emdee/toxygen_wrapper/src/branch/main/src/tox_wrapper/tests/tests_wrapper.py). But lets get this done at least.",
            "created_at": "2024-02-05T01:19:23Z",
            "html_url": "https://github.com/TokTok/c-toxcore/issues/2469#issuecomment-1926050160",
            "id": 1926050160,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469",
            "node_id": "IC_kwDOA7zIGs5yzTFw",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1926050160/reactions"
            },
            "updated_at": "2024-02-05T01:20:10Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1926050160",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/109981937?v=4",
                "events_url": "https://api.github.com/users/emdee-is/events{/privacy}",
                "followers_url": "https://api.github.com/users/emdee-is/followers",
                "following_url": "https://api.github.com/users/emdee-is/following{/other_user}",
                "gists_url": "https://api.github.com/users/emdee-is/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/emdee-is",
                "id": 109981937,
                "login": "emdee-is",
                "node_id": "U_kgDOBo4w8Q",
                "organizations_url": "https://api.github.com/users/emdee-is/orgs",
                "received_events_url": "https://api.github.com/users/emdee-is/received_events",
                "repos_url": "https://api.github.com/users/emdee-is/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/emdee-is/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/emdee-is/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/emdee-is",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 13,
    "comments_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469/comments",
    "created_at": "2023-12-14T16:44:16Z",
    "event_data": [
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2938071?v=4",
                "events_url": "https://api.github.com/users/Green-Sky/events{/privacy}",
                "followers_url": "https://api.github.com/users/Green-Sky/followers",
                "following_url": "https://api.github.com/users/Green-Sky/following{/other_user}",
                "gists_url": "https://api.github.com/users/Green-Sky/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Green-Sky",
                "id": 2938071,
                "login": "Green-Sky",
                "node_id": "MDQ6VXNlcjI5MzgwNzE=",
                "organizations_url": "https://api.github.com/users/Green-Sky/orgs",
                "received_events_url": "https://api.github.com/users/Green-Sky/received_events",
                "repos_url": "https://api.github.com/users/Green-Sky/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Green-Sky/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Green-Sky/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Green-Sky",
                "user_view_type": "public"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2024-02-04T21:14:11Z",
            "event": "mentioned",
            "id": 11696543158,
            "node_id": "MEE_lADOA7zIGs55t424zwAAAAK5KxW2",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/11696543158"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/2938071?v=4",
                "events_url": "https://api.github.com/users/Green-Sky/events{/privacy}",
                "followers_url": "https://api.github.com/users/Green-Sky/followers",
                "following_url": "https://api.github.com/users/Green-Sky/following{/other_user}",
                "gists_url": "https://api.github.com/users/Green-Sky/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/Green-Sky",
                "id": 2938071,
                "login": "Green-Sky",
                "node_id": "MDQ6VXNlcjI5MzgwNzE=",
                "organizations_url": "https://api.github.com/users/Green-Sky/orgs",
                "received_events_url": "https://api.github.com/users/Green-Sky/received_events",
                "repos_url": "https://api.github.com/users/Green-Sky/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/Green-Sky/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/Green-Sky/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/Green-Sky",
                "user_view_type": "public"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2024-02-04T21:14:11Z",
            "event": "subscribed",
            "id": 11696543161,
            "node_id": "SE_lADOA7zIGs55t424zwAAAAK5KxW5",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/11696543161"
        },
        {
            "actor": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf",
                "user_view_type": "public"
            },
            "commit_id": null,
            "commit_url": null,
            "created_at": "2024-02-13T00:39:09Z",
            "event": "milestoned",
            "id": 11781554009,
            "milestone": {
                "title": "v0.2.x"
            },
            "node_id": "MIE_lADOA7zIGs55t424zwAAAAK-PD9Z",
            "performed_via_github_app": null,
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events/11781554009"
        }
    ],
    "events_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469/events",
    "html_url": "https://github.com/TokTok/c-toxcore/issues/2469",
    "id": 2042072504,
    "labels": [],
    "labels_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469/labels{/name}",
    "locked": false,
    "milestone": {
        "closed_at": null,
        "closed_issues": 0,
        "created_at": "2018-03-09T13:13:48Z",
        "creator": {
            "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
            "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
            "followers_url": "https://api.github.com/users/iphydf/followers",
            "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
            "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/iphydf",
            "id": 10647936,
            "login": "iphydf",
            "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
            "organizations_url": "https://api.github.com/users/iphydf/orgs",
            "received_events_url": "https://api.github.com/users/iphydf/received_events",
            "repos_url": "https://api.github.com/users/iphydf/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/iphydf",
            "user_view_type": "public"
        },
        "description": "Placeholder for the next 0.2.x version.",
        "due_on": null,
        "html_url": "https://github.com/TokTok/c-toxcore/milestone/28",
        "id": 3174131,
        "labels_url": "https://api.github.com/repos/TokTok/c-toxcore/milestones/28/labels",
        "node_id": "MDk6TWlsZXN0b25lMzE3NDEzMQ==",
        "number": 28,
        "open_issues": 160,
        "state": "open",
        "title": "v0.2.x",
        "updated_at": "2025-01-14T12:48:29Z",
        "url": "https://api.github.com/repos/TokTok/c-toxcore/milestones/28"
    },
    "node_id": "I_kwDOA7zIGs55t424",
    "number": 2469,
    "performed_via_github_app": null,
    "reactions": {
        "+1": 0,
        "-1": 0,
        "confused": 0,
        "eyes": 0,
        "heart": 0,
        "hooray": 0,
        "laugh": 0,
        "rocket": 0,
        "total_count": 0,
        "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469/reactions"
    },
    "repository_url": "https://api.github.com/repos/TokTok/c-toxcore",
    "state": "open",
    "state_reason": null,
    "sub_issues_summary": {
        "completed": 0,
        "percent_completed": 0,
        "total": 0
    },
    "timeline_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469/timeline",
    "title": "-DSOCKS_HOST_TEST and -DSOCKS_PORT_TEST for testing",
    "updated_at": "2024-02-13T00:39:09Z",
    "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2469",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/109981937?v=4",
        "events_url": "https://api.github.com/users/emdee-is/events{/privacy}",
        "followers_url": "https://api.github.com/users/emdee-is/followers",
        "following_url": "https://api.github.com/users/emdee-is/following{/other_user}",
        "gists_url": "https://api.github.com/users/emdee-is/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/emdee-is",
        "id": 109981937,
        "login": "emdee-is",
        "node_id": "U_kgDOBo4w8Q",
        "organizations_url": "https://api.github.com/users/emdee-is/orgs",
        "received_events_url": "https://api.github.com/users/emdee-is/received_events",
        "repos_url": "https://api.github.com/users/emdee-is/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/emdee-is/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/emdee-is/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/emdee-is",
        "user_view_type": "public"
    }
}