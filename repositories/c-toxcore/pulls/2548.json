{
    "_links": {
        "comments": {
            "href": "https://api.github.com/repos/TokTok/c-toxcore/issues/2548/comments"
        },
        "commits": {
            "href": "https://api.github.com/repos/TokTok/c-toxcore/pulls/2548/commits"
        },
        "html": {
            "href": "https://github.com/TokTok/c-toxcore/pull/2548"
        },
        "issue": {
            "href": "https://api.github.com/repos/TokTok/c-toxcore/issues/2548"
        },
        "review_comment": {
            "href": "https://api.github.com/repos/TokTok/c-toxcore/pulls/comments{/number}"
        },
        "review_comments": {
            "href": "https://api.github.com/repos/TokTok/c-toxcore/pulls/2548/comments"
        },
        "self": {
            "href": "https://api.github.com/repos/TokTok/c-toxcore/pulls/2548"
        },
        "statuses": {
            "href": "https://api.github.com/repos/TokTok/c-toxcore/statuses/bcb6592af5496f17417f71924fbf0bcbbd03fe06"
        }
    },
    "active_lock_reason": null,
    "additions": 0,
    "assignee": {
        "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
        "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
        "followers_url": "https://api.github.com/users/iphydf/followers",
        "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
        "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/iphydf",
        "id": 10647936,
        "login": "iphydf",
        "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
        "organizations_url": "https://api.github.com/users/iphydf/orgs",
        "received_events_url": "https://api.github.com/users/iphydf/received_events",
        "repos_url": "https://api.github.com/users/iphydf/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/iphydf",
        "user_view_type": "public"
    },
    "assignees": [
        {
            "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
            "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
            "followers_url": "https://api.github.com/users/iphydf/followers",
            "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
            "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/iphydf",
            "id": 10647936,
            "login": "iphydf",
            "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
            "organizations_url": "https://api.github.com/users/iphydf/orgs",
            "received_events_url": "https://api.github.com/users/iphydf/received_events",
            "repos_url": "https://api.github.com/users/iphydf/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
            "type": "User",
            "url": "https://api.github.com/users/iphydf",
            "user_view_type": "public"
        }
    ],
    "author_association": "MEMBER",
    "auto_merge": null,
    "base": {
        "label": "TokTok:master",
        "ref": "master",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/TokTok/c-toxcore/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/TokTok/c-toxcore/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/TokTok/c-toxcore/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/TokTok/c-toxcore/branches{/branch}",
            "clone_url": "https://github.com/TokTok/c-toxcore.git",
            "collaborators_url": "https://api.github.com/repos/TokTok/c-toxcore/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/TokTok/c-toxcore/comments{/number}",
            "commits_url": "https://api.github.com/repos/TokTok/c-toxcore/commits{/sha}",
            "compare_url": "https://api.github.com/repos/TokTok/c-toxcore/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/TokTok/c-toxcore/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/TokTok/c-toxcore/contributors",
            "created_at": "2016-07-06T08:15:22Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/TokTok/c-toxcore/deployments",
            "description": "The future of online communications.",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/TokTok/c-toxcore/downloads",
            "events_url": "https://api.github.com/repos/TokTok/c-toxcore/events",
            "fork": true,
            "forks": 292,
            "forks_count": 292,
            "forks_url": "https://api.github.com/repos/TokTok/c-toxcore/forks",
            "full_name": "TokTok/c-toxcore",
            "git_commits_url": "https://api.github.com/repos/TokTok/c-toxcore/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/TokTok/c-toxcore/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/TokTok/c-toxcore/git/tags{/sha}",
            "git_url": "git://github.com/TokTok/c-toxcore.git",
            "has_discussions": false,
            "has_downloads": false,
            "has_issues": true,
            "has_pages": false,
            "has_projects": false,
            "has_wiki": false,
            "homepage": "https://tox.chat",
            "hooks_url": "https://api.github.com/repos/TokTok/c-toxcore/hooks",
            "html_url": "https://github.com/TokTok/c-toxcore",
            "id": 62703642,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/TokTok/c-toxcore/issues{/number}",
            "keys_url": "https://api.github.com/repos/TokTok/c-toxcore/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/TokTok/c-toxcore/labels{/name}",
            "language": "C",
            "languages_url": "https://api.github.com/repos/TokTok/c-toxcore/languages",
            "license": {
                "key": "gpl-3.0",
                "name": "GNU General Public License v3.0",
                "node_id": "MDc6TGljZW5zZTk=",
                "spdx_id": "GPL-3.0",
                "url": "https://api.github.com/licenses/gpl-3.0"
            },
            "merges_url": "https://api.github.com/repos/TokTok/c-toxcore/merges",
            "milestones_url": "https://api.github.com/repos/TokTok/c-toxcore/milestones{/number}",
            "mirror_url": null,
            "name": "c-toxcore",
            "node_id": "MDEwOlJlcG9zaXRvcnk2MjcwMzY0Mg==",
            "notifications_url": "https://api.github.com/repos/TokTok/c-toxcore/notifications{?since,all,participating}",
            "open_issues": 210,
            "open_issues_count": 210,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/17427091?v=4",
                "events_url": "https://api.github.com/users/TokTok/events{/privacy}",
                "followers_url": "https://api.github.com/users/TokTok/followers",
                "following_url": "https://api.github.com/users/TokTok/following{/other_user}",
                "gists_url": "https://api.github.com/users/TokTok/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/TokTok",
                "id": 17427091,
                "login": "TokTok",
                "node_id": "MDEyOk9yZ2FuaXphdGlvbjE3NDI3MDkx",
                "organizations_url": "https://api.github.com/users/TokTok/orgs",
                "received_events_url": "https://api.github.com/users/TokTok/received_events",
                "repos_url": "https://api.github.com/users/TokTok/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/TokTok/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/TokTok/subscriptions",
                "type": "Organization",
                "url": "https://api.github.com/users/TokTok",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/TokTok/c-toxcore/pulls{/number}",
            "pushed_at": "2025-01-24T18:18:40Z",
            "releases_url": "https://api.github.com/repos/TokTok/c-toxcore/releases{/id}",
            "size": 25245,
            "ssh_url": "git@github.com:TokTok/c-toxcore.git",
            "stargazers_count": 2329,
            "stargazers_url": "https://api.github.com/repos/TokTok/c-toxcore/stargazers",
            "statuses_url": "https://api.github.com/repos/TokTok/c-toxcore/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/TokTok/c-toxcore/subscribers",
            "subscription_url": "https://api.github.com/repos/TokTok/c-toxcore/subscription",
            "svn_url": "https://github.com/TokTok/c-toxcore",
            "tags_url": "https://api.github.com/repos/TokTok/c-toxcore/tags",
            "teams_url": "https://api.github.com/repos/TokTok/c-toxcore/teams",
            "topics": [
                "cryptography",
                "encryption",
                "network",
                "p2p",
                "security",
                "toxcore"
            ],
            "trees_url": "https://api.github.com/repos/TokTok/c-toxcore/git/trees{/sha}",
            "updated_at": "2025-01-24T22:05:30Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore",
            "visibility": "public",
            "watchers": 2329,
            "watchers_count": 2329,
            "web_commit_signoff_required": false
        },
        "sha": "bcb6592af5496f17417f71924fbf0bcbbd03fe06",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/17427091?v=4",
            "events_url": "https://api.github.com/users/TokTok/events{/privacy}",
            "followers_url": "https://api.github.com/users/TokTok/followers",
            "following_url": "https://api.github.com/users/TokTok/following{/other_user}",
            "gists_url": "https://api.github.com/users/TokTok/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/TokTok",
            "id": 17427091,
            "login": "TokTok",
            "node_id": "MDEyOk9yZ2FuaXphdGlvbjE3NDI3MDkx",
            "organizations_url": "https://api.github.com/users/TokTok/orgs",
            "received_events_url": "https://api.github.com/users/TokTok/received_events",
            "repos_url": "https://api.github.com/users/TokTok/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/TokTok/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/TokTok/subscriptions",
            "type": "Organization",
            "url": "https://api.github.com/users/TokTok",
            "user_view_type": "public"
        }
    },
    "body": "feat: Building c-toxcore with zig.\r\nThe dependencies are in build.zig.zon \r\nThe build.zig contains the build details.\r\nBuild the library: zig build install \r\nAllows cross compilation by specifying the target with eg -Dtarget=x86_64-windows-gnu\r\nGoogle test and google mock test files are also build.\r\n\r\n<!-- Reviewable:start -->\r\n- - -\r\nThis change is [<img src=\"https://reviewable.io/review_button.svg\" height=\"34\" align=\"absmiddle\" alt=\"Reviewable\"/>](https://reviewable.io/reviews/TokTok/c-toxcore/2548)\r\n<!-- Reviewable:end -->\r\n",
    "changed_files": 0,
    "closed_at": "2024-01-13T21:35:15Z",
    "comment_data": [
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/c-toxcore/pull/2548#discussion_r1451405465"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/c-toxcore/pulls/2548"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/c-toxcore/pulls/comments/1451405465"
                }
            },
            "author_association": "MEMBER",
            "body": "Can we extract this list from the cmake code? I'd like to address nurupo's very valid concern by making this build system as easy to maintain as any other ci check. E.g. the conanfile is kind of a build system wrapper around cmake. If we can make the zig one a wrapper too, I think it would be less of a concern.",
            "commit_id": "bcb6592af5496f17417f71924fbf0bcbbd03fe06",
            "created_at": "2024-01-13T09:06:33Z",
            "diff_hunk": "@@ -0,0 +1,259 @@\n+const std = @import(\"std\");\n+const Build = std.Build;\n+const Step = Build.Step;\n+const Compile = Step.Compile;\n+const Dependency = Build.Dependency;\n+const fs = std.fs;\n+\n+pub fn build(b: *Build) !void {\n+    const target = b.standardTargetOptions(.{});\n+    const optimize = b.standardOptimizeOption(.{});\n+\n+    const libsodium_dep = b.dependency(\n+        \"libsodium\",\n+        .{ .target = target, .optimize = optimize, .static = true, .shared = false },\n+    );\n+    const libsodium = libsodium_dep.artifact(\"sodium\");\n+\n+    const win_build = target.result.isMinGW();\n+    var winpthreads_dep: ?*Dependency = null;\n+    var winpthreads: ?*Compile = null;\n+    if (win_build) {\n+        winpthreads_dep = b.dependency(\n+            \"winpthreads\",\n+            .{ .target = target, .optimize = optimize },\n+        );\n+        winpthreads =\n+            winpthreads_dep.?.artifact(\"winpthreads\");\n+    }\n+    const gt_dep = b.dependency(\"gtest\", .{ .target = target, .optimize = optimize });\n+    const cmp_dep = b.dependency(\"cmp\", .{});\n+    // we copy the third_party dependencies into the source tree\n+    // not an ideal solution but we need them there and git\n+    // submodule want work for zig dependency snapshots.\n+    // we do the copy only if the file does not exist at the\n+    // target position\n+    const copy_files = b.addWriteFiles();\n+    inline for (.{ \"cmp.h\", \"cmp.c\" }) |file| {\n+        const rpath = b.pathJoin(&.{ \"third_party/cmp\", file });\n+        const apath = b.pathFromRoot(rpath);\n+        if (fs.accessAbsolute(apath, .{})) |_| {} else |_| {\n+            // if the file does not exist we copy it\n+            _ = copy_files.addCopyFileToSource(\n+                .{ .dependency = .{ .dependency = cmp_dep, .sub_path = file } },\n+                rpath,\n+            );\n+        }\n+    }\n+\n+    const lib_src_files = &.{",
            "html_url": "https://github.com/TokTok/c-toxcore/pull/2548#discussion_r1451405465",
            "id": 1451405465,
            "line": null,
            "node_id": "PRRC_kwDOA7zIGs5WgrCZ",
            "original_commit_id": "2d903341697c75fa1124b7b76bfa4483138b0880",
            "original_line": 49,
            "original_position": 49,
            "original_start_line": null,
            "path": "build.zig",
            "position": null,
            "pull_request_review_id": 1819946366,
            "pull_request_url": "https://api.github.com/repos/TokTok/c-toxcore/pulls/2548",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/pulls/comments/1451405465/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2024-01-13T09:06:40Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/pulls/comments/1451405465",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/10647936?v=4",
                "events_url": "https://api.github.com/users/iphydf/events{/privacy}",
                "followers_url": "https://api.github.com/users/iphydf/followers",
                "following_url": "https://api.github.com/users/iphydf/following{/other_user}",
                "gists_url": "https://api.github.com/users/iphydf/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/iphydf",
                "id": 10647936,
                "login": "iphydf",
                "node_id": "MDQ6VXNlcjEwNjQ3OTM2",
                "organizations_url": "https://api.github.com/users/iphydf/orgs",
                "received_events_url": "https://api.github.com/users/iphydf/received_events",
                "repos_url": "https://api.github.com/users/iphydf/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/iphydf/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/iphydf/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/iphydf",
                "user_view_type": "public"
            }
        },
        {
            "_links": {
                "html": {
                    "href": "https://github.com/TokTok/c-toxcore/pull/2548#discussion_r1451569561"
                },
                "pull_request": {
                    "href": "https://api.github.com/repos/TokTok/c-toxcore/pulls/2548"
                },
                "self": {
                    "href": "https://api.github.com/repos/TokTok/c-toxcore/pulls/comments/1451569561"
                }
            },
            "author_association": "MEMBER",
            "body": "This means parsing of Makefile.inc and use the files in the libtoxcore_la_SOURCES variable. \r\nAnd we drop the gtest stuff for now? For the downstream zig use they are not important anyway.\r\nBut then maybe we should use a fixed zig version for CI because a new zig could require the change of build.zig and this would be a bourdon for other maintainers.",
            "commit_id": "bcb6592af5496f17417f71924fbf0bcbbd03fe06",
            "created_at": "2024-01-13T16:47:43Z",
            "diff_hunk": "@@ -0,0 +1,259 @@\n+const std = @import(\"std\");\n+const Build = std.Build;\n+const Step = Build.Step;\n+const Compile = Step.Compile;\n+const Dependency = Build.Dependency;\n+const fs = std.fs;\n+\n+pub fn build(b: *Build) !void {\n+    const target = b.standardTargetOptions(.{});\n+    const optimize = b.standardOptimizeOption(.{});\n+\n+    const libsodium_dep = b.dependency(\n+        \"libsodium\",\n+        .{ .target = target, .optimize = optimize, .static = true, .shared = false },\n+    );\n+    const libsodium = libsodium_dep.artifact(\"sodium\");\n+\n+    const win_build = target.result.isMinGW();\n+    var winpthreads_dep: ?*Dependency = null;\n+    var winpthreads: ?*Compile = null;\n+    if (win_build) {\n+        winpthreads_dep = b.dependency(\n+            \"winpthreads\",\n+            .{ .target = target, .optimize = optimize },\n+        );\n+        winpthreads =\n+            winpthreads_dep.?.artifact(\"winpthreads\");\n+    }\n+    const gt_dep = b.dependency(\"gtest\", .{ .target = target, .optimize = optimize });\n+    const cmp_dep = b.dependency(\"cmp\", .{});\n+    // we copy the third_party dependencies into the source tree\n+    // not an ideal solution but we need them there and git\n+    // submodule want work for zig dependency snapshots.\n+    // we do the copy only if the file does not exist at the\n+    // target position\n+    const copy_files = b.addWriteFiles();\n+    inline for (.{ \"cmp.h\", \"cmp.c\" }) |file| {\n+        const rpath = b.pathJoin(&.{ \"third_party/cmp\", file });\n+        const apath = b.pathFromRoot(rpath);\n+        if (fs.accessAbsolute(apath, .{})) |_| {} else |_| {\n+            // if the file does not exist we copy it\n+            _ = copy_files.addCopyFileToSource(\n+                .{ .dependency = .{ .dependency = cmp_dep, .sub_path = file } },\n+                rpath,\n+            );\n+        }\n+    }\n+\n+    const lib_src_files = &.{",
            "html_url": "https://github.com/TokTok/c-toxcore/pull/2548#discussion_r1451569561",
            "id": 1451569561,
            "in_reply_to_id": 1451405465,
            "line": null,
            "node_id": "PRRC_kwDOA7zIGs5WhTGZ",
            "original_commit_id": "2d903341697c75fa1124b7b76bfa4483138b0880",
            "original_line": 49,
            "original_position": 49,
            "original_start_line": null,
            "path": "build.zig",
            "position": null,
            "pull_request_review_id": 1820059879,
            "pull_request_url": "https://api.github.com/repos/TokTok/c-toxcore/pulls/2548",
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/pulls/comments/1451569561/reactions"
            },
            "side": "RIGHT",
            "start_line": null,
            "start_side": null,
            "subject_type": "line",
            "updated_at": "2024-01-13T16:47:43Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/pulls/comments/1451569561",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6729524?v=4",
                "events_url": "https://api.github.com/users/freylax/events{/privacy}",
                "followers_url": "https://api.github.com/users/freylax/followers",
                "following_url": "https://api.github.com/users/freylax/following{/other_user}",
                "gists_url": "https://api.github.com/users/freylax/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/freylax",
                "id": 6729524,
                "login": "freylax",
                "node_id": "MDQ6VXNlcjY3Mjk1MjQ=",
                "organizations_url": "https://api.github.com/users/freylax/orgs",
                "received_events_url": "https://api.github.com/users/freylax/received_events",
                "repos_url": "https://api.github.com/users/freylax/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/freylax/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/freylax/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/freylax",
                "user_view_type": "public"
            }
        }
    ],
    "comment_regular_data": [
        {
            "author_association": "NONE",
            "body": "## [Codecov](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=h1&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok) Report\nAttention: `264 lines` in your changes are missing coverage. Please review.\n> Comparison is base [(`24b5472`)](https://app.codecov.io/gh/TokTok/c-toxcore/commit/24b54722aed65b02f1e921f08f8d31d68f92a45a?el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok) 74.43% compared to head [(`2d90334`)](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=desc&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok) 68.97%.\n> Report is 111 commits behind head on master.\n\n> :exclamation: Current head 2d90334 differs from pull request most recent head ad30f63. Consider uploading reports for the commit ad30f63 to get more accurate results\n\n| [Files](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok) | Patch % | Lines |\n|---|---|---|\n| [toxcore/tox.c](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok#diff-dG94Y29yZS90b3guYw==) | 58.33% | [35 Missing :warning: ](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok) |\n| [toxcore/DHT\\_test.cc](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok#diff-dG94Y29yZS9ESFRfdGVzdC5jYw==) | 73.80% | [33 Missing :warning: ](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok) |\n| [toxcore/group\\_chats.c](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok#diff-dG94Y29yZS9ncm91cF9jaGF0cy5j) | 80.00% | [20 Missing :warning: ](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok) |\n| [toxcore/group\\_pack.c](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok#diff-dG94Y29yZS9ncm91cF9wYWNrLmM=) | 67.92% | [17 Missing :warning: ](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok) |\n| [toxcore/onion\\_client.c](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok#diff-dG94Y29yZS9vbmlvbl9jbGllbnQuYw==) | 70.90% | [16 Missing :warning: ](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok) |\n| [toxcore/group\\_connection.c](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok#diff-dG94Y29yZS9ncm91cF9jb25uZWN0aW9uLmM=) | 63.15% | [14 Missing :warning: ](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok) |\n| [toxcore/Messenger.c](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok#diff-dG94Y29yZS9NZXNzZW5nZXIuYw==) | 72.72% | [12 Missing :warning: ](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok) |\n| [toxcore/crypto\\_core\\_test\\_util.cc](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok#diff-dG94Y29yZS9jcnlwdG9fY29yZV90ZXN0X3V0aWwuY2M=) | 41.17% | [10 Missing :warning: ](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok) |\n| [toxcore/network\\_test\\_util.cc](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok#diff-dG94Y29yZS9uZXR3b3JrX3Rlc3RfdXRpbC5jYw==) | 73.68% | [10 Missing :warning: ](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok) |\n| [toxcore/events/conference\\_invite.c](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok#diff-dG94Y29yZS9ldmVudHMvY29uZmVyZW5jZV9pbnZpdGUuYw==) | 0.00% | [6 Missing :warning: ](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok) |\n| ... and [31 more](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=tree-more&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok) | |\n\n<details><summary>Additional details and impacted files</summary>\n\n\n```diff\n@@            Coverage Diff             @@\n##           master    #2548      +/-   ##\n==========================================\n- Coverage   74.43%   68.97%   -5.47%     \n==========================================\n  Files          87       96       +9     \n  Lines       26192    28054    +1862     \n==========================================\n- Hits        19495    19349     -146     \n- Misses       6697     8705    +2008     \n```\n\n\n\n</details>\n\n[:umbrella: View full report in Codecov by Sentry](https://app.codecov.io/gh/TokTok/c-toxcore/pull/2548?src=pr&el=continue&utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok).   \n:loudspeaker: Have feedback on the report? [Share it here](https://about.codecov.io/codecov-pr-comment-feedback/?utm_medium=referral&utm_source=github&utm_content=comment&utm_campaign=pr+comments&utm_term=TokTok).\n",
            "created_at": "2024-01-11T15:44:39Z",
            "html_url": "https://github.com/TokTok/c-toxcore/pull/2548#issuecomment-1887447396",
            "id": 1887447396,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2548",
            "node_id": "IC_kwDOA7zIGs5wgClk",
            "performed_via_github_app": {
                "client_id": "Iv1.9d88ef6ecc903626",
                "created_at": "2016-09-25T14:18:27Z",
                "description": "Codecov provides highly integrated tools to group, merge, archive and compare coverage reports. Whether your team is comparing changes in a pull request or reviewing a single commit, Codecov will improve the code review workflow and quality.\r\n\r\n## Code coverage done right.®\r\n\r\n1. Upload coverage reports from your CI builds.\r\n2. Codecov merges all builds and languages into one beautiful coherent report.\r\n3. Get commit statuses, pull request comments and coverage overlay via our browser extension.\r\n\r\nWhen Codecov merges your uploads it keeps track of the CI provider (inc. build details) and user specified context, e.g. `#unittest` ~ `#smoketest` or `#oldcode` ~ `#newcode`. You can track the `#unittest` coverage independently of other groups. [Learn more here](\r\nhttp://docs.codecov.io/docs/flags)\r\n\r\nThrough **Codecov's Browser Extension** reports overlay directly in GitHub UI to assist in code review in [Chrome](https://chrome.google.com/webstore/detail/codecov/gedikamndpbemklijjkncpnolildpbgo) or Firefox (https://addons.mozilla.org/en-US/firefox/addon/codecov/)\r\n\r\n*Highly detailed* **pull request comments** and *customizable* **commit statuses** will improve your team's workflow and code coverage incrementally.\r\n\r\n**File backed configuration** all through the `codecov.yml`. \r\n\r\n## FAQ\r\n- Do you **merge multiple uploads** to the same commit? **Yes**\r\n- Do you **support multiple languages** in the same project? **Yes**\r\n- Can you **group coverage reports** by project and/or test type? **Yes**\r\n- How does **pricing** work? Only paid users can view reports and post statuses/comments. ",
                "events": [
                    "check_run",
                    "check_suite",
                    "create",
                    "delete",
                    "fork",
                    "member",
                    "membership",
                    "organization",
                    "public",
                    "pull_request",
                    "push",
                    "release",
                    "repository",
                    "status",
                    "team_add"
                ],
                "external_url": "https://codecov.io",
                "html_url": "https://github.com/apps/codecov",
                "id": 254,
                "name": "Codecov",
                "node_id": "MDM6QXBwMjU0",
                "owner": {
                    "avatar_url": "https://avatars.githubusercontent.com/u/8226205?v=4",
                    "events_url": "https://api.github.com/users/codecov/events{/privacy}",
                    "followers_url": "https://api.github.com/users/codecov/followers",
                    "following_url": "https://api.github.com/users/codecov/following{/other_user}",
                    "gists_url": "https://api.github.com/users/codecov/gists{/gist_id}",
                    "gravatar_id": "",
                    "html_url": "https://github.com/codecov",
                    "id": 8226205,
                    "login": "codecov",
                    "node_id": "MDEyOk9yZ2FuaXphdGlvbjgyMjYyMDU=",
                    "organizations_url": "https://api.github.com/users/codecov/orgs",
                    "received_events_url": "https://api.github.com/users/codecov/received_events",
                    "repos_url": "https://api.github.com/users/codecov/repos",
                    "site_admin": false,
                    "starred_url": "https://api.github.com/users/codecov/starred{/owner}{/repo}",
                    "subscriptions_url": "https://api.github.com/users/codecov/subscriptions",
                    "type": "Organization",
                    "url": "https://api.github.com/users/codecov",
                    "user_view_type": "public"
                },
                "permissions": {
                    "administration": "read",
                    "checks": "write",
                    "contents": "read",
                    "emails": "read",
                    "issues": "read",
                    "members": "read",
                    "metadata": "read",
                    "pull_requests": "write",
                    "statuses": "write"
                },
                "slug": "codecov",
                "updated_at": "2023-09-08T15:29:16Z"
            },
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1887447396/reactions"
            },
            "updated_at": "2024-01-13T21:31:20Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1887447396",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/in/254?v=4",
                "events_url": "https://api.github.com/users/codecov%5Bbot%5D/events{/privacy}",
                "followers_url": "https://api.github.com/users/codecov%5Bbot%5D/followers",
                "following_url": "https://api.github.com/users/codecov%5Bbot%5D/following{/other_user}",
                "gists_url": "https://api.github.com/users/codecov%5Bbot%5D/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/apps/codecov",
                "id": 22429695,
                "login": "codecov[bot]",
                "node_id": "MDM6Qm90MjI0Mjk2OTU=",
                "organizations_url": "https://api.github.com/users/codecov%5Bbot%5D/orgs",
                "received_events_url": "https://api.github.com/users/codecov%5Bbot%5D/received_events",
                "repos_url": "https://api.github.com/users/codecov%5Bbot%5D/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/codecov%5Bbot%5D/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/codecov%5Bbot%5D/subscriptions",
                "type": "Bot",
                "url": "https://api.github.com/users/codecov%5Bbot%5D",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Toxcore already uses  3 build systems: autotools, bazel and cmake. A normal project typically uses just one. There should be a very compelling reason for adding yet another build system. I'm all ears.",
            "created_at": "2024-01-11T19:12:59Z",
            "html_url": "https://github.com/TokTok/c-toxcore/pull/2548#issuecomment-1887797247",
            "id": 1887797247,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2548",
            "node_id": "IC_kwDOA7zIGs5whX__",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1887797247/reactions"
            },
            "updated_at": "2024-01-11T19:12:59Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1887797247",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1855294?v=4",
                "events_url": "https://api.github.com/users/nurupo/events{/privacy}",
                "followers_url": "https://api.github.com/users/nurupo/followers",
                "following_url": "https://api.github.com/users/nurupo/following{/other_user}",
                "gists_url": "https://api.github.com/users/nurupo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/nurupo",
                "id": 1855294,
                "login": "nurupo",
                "node_id": "MDQ6VXNlcjE4NTUyOTQ=",
                "organizations_url": "https://api.github.com/users/nurupo/orgs",
                "received_events_url": "https://api.github.com/users/nurupo/received_events",
                "repos_url": "https://api.github.com/users/nurupo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/nurupo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/nurupo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/nurupo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "The reason to have c-toxcore build by zig is that this is very good includable for zig. We can write easy an wrapper in zig or we use c-toxcore as reference test for an zig toxcore implementation. Libsodium by the way does use zig as build system among others.",
            "created_at": "2024-01-11T22:26:00Z",
            "html_url": "https://github.com/TokTok/c-toxcore/pull/2548#issuecomment-1888067521",
            "id": 1888067521,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2548",
            "node_id": "IC_kwDOA7zIGs5wiZ_B",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1888067521/reactions"
            },
            "updated_at": "2024-01-11T22:26:00Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1888067521",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6729524?v=4",
                "events_url": "https://api.github.com/users/freylax/events{/privacy}",
                "followers_url": "https://api.github.com/users/freylax/followers",
                "following_url": "https://api.github.com/users/freylax/following{/other_user}",
                "gists_url": "https://api.github.com/users/freylax/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/freylax",
                "id": 6729524,
                "login": "freylax",
                "node_id": "MDQ6VXNlcjY3Mjk1MjQ=",
                "organizations_url": "https://api.github.com/users/freylax/orgs",
                "received_events_url": "https://api.github.com/users/freylax/received_events",
                "repos_url": "https://api.github.com/users/freylax/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/freylax/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/freylax/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/freylax",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": ">The reason to have c-toxcore build by zig is that this is very good includable for zig.\r\n\r\nIf we go down this rabbit hole, next we will be adding build systems for Nim, Crystal, Go, Java, Python, Haskell, Rust, etc., and will end up with 20+ build systems because \"this is very good includable for X\".\r\n\r\n>We can write easy an wrapper in zig or we use c-toxcore as reference test for an zig toxcore implementation.\r\n\r\nThere is already a wrapper being written for Zig, https://github.com/TokTok/zig-toxcore-c, by you, in fact. Doesn't Zig have a way to link against a C library that was already built with autotools/bazel/cmake? There shouldn't be a need to add a Zig build system for that.\r\n\r\nIs someone re-implementing toxcore in Zig? Could you link that project? Also, I don't see how having toxcore being built using a Zig build system would be any different than building it using autotools/bazel/cmake, and what role does a build system even have in testing the resulting toxcore binary against another toxcore implementation? One would typically write a separate testing program for that, independent of the build system, instead of coding it as a part of a build system.\r\n\r\n---\r\n\r\nThere should be a very compelling reason for adding yet another build system and I have yet to see any compelling reason being mentioned.\r\n\r\nToxcore already uses 3 build systems: autotools, bazel and cmake, which I think is already a bit too much. Having to maintain 4 of them doesn't help the situation. Each build system is a maintenance burden and it quickly adds up, to the point that changing something non-trivial in the build process of toxcore would require knowing autotools, bazel, cmake and now zig, which I'm not sure if we even have a person who knows all 4 of those. We shouldn't be adding a yet another build system without a good reason.\r\n\r\nIf a Zig build system brings something desirable to toxcore that none of the other build systems toxcore uses do, then it might be worth considering. But if it's no better than the 3 build systems toxcore already uses, then what is the point?\r\n\r\nThen there is also the question if any of the regular contributors know Zig and if any of them would be willing to maintain this Zig build system. If it goes unmaintained once it gets merged, then what is the point?",
            "created_at": "2024-01-13T05:26:00Z",
            "html_url": "https://github.com/TokTok/c-toxcore/pull/2548#issuecomment-1890324193",
            "id": 1890324193,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2548",
            "node_id": "IC_kwDOA7zIGs5wrA7h",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1890324193/reactions"
            },
            "updated_at": "2024-01-13T05:26:00Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1890324193",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1855294?v=4",
                "events_url": "https://api.github.com/users/nurupo/events{/privacy}",
                "followers_url": "https://api.github.com/users/nurupo/followers",
                "following_url": "https://api.github.com/users/nurupo/following{/other_user}",
                "gists_url": "https://api.github.com/users/nurupo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/nurupo",
                "id": 1855294,
                "login": "nurupo",
                "node_id": "MDQ6VXNlcjE4NTUyOTQ=",
                "organizations_url": "https://api.github.com/users/nurupo/orgs",
                "received_events_url": "https://api.github.com/users/nurupo/received_events",
                "repos_url": "https://api.github.com/users/nurupo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/nurupo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/nurupo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/nurupo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "To me this PR look like someone wrote a build system in their favorite programming language just for the fun of it, not because the build system would benefit the project being built, and is now trying to push it upstream. Similar to if someone tried to contribute a SCons build script for toxcore just because they are very passionate about Python and SCons. Good for you, but it doesn't really make sense for toxcore to accept such a PR.",
            "created_at": "2024-01-13T05:39:23Z",
            "html_url": "https://github.com/TokTok/c-toxcore/pull/2548#issuecomment-1890328490",
            "id": 1890328490,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2548",
            "node_id": "IC_kwDOA7zIGs5wrB-q",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1890328490/reactions"
            },
            "updated_at": "2024-01-13T05:39:23Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1890328490",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1855294?v=4",
                "events_url": "https://api.github.com/users/nurupo/events{/privacy}",
                "followers_url": "https://api.github.com/users/nurupo/followers",
                "following_url": "https://api.github.com/users/nurupo/following{/other_user}",
                "gists_url": "https://api.github.com/users/nurupo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/nurupo",
                "id": 1855294,
                "login": "nurupo",
                "node_id": "MDQ6VXNlcjE4NTUyOTQ=",
                "organizations_url": "https://api.github.com/users/nurupo/orgs",
                "received_events_url": "https://api.github.com/users/nurupo/received_events",
                "repos_url": "https://api.github.com/users/nurupo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/nurupo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/nurupo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/nurupo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "This PR got some thumb-ups, so I assume those who left them consider the Zig build system to be somehow desirable, yet somehow no one managed to provide a reason of why we want toxcore to support a 4th build system, either on here on github or in the chat.\r\n\r\nSince I don't know anything about Zig, I done some reading to learn more about it.\r\n\r\n<details><summary>(A couple of paragraphs on the Zig C/C++ (cross-)compiler, which I found interesting and which I initially thought was the reason for the `build.zig` inclusion, but later realized that not being the case, so they can be skipped.)\r\n</summary>\r\n\r\n---\r\n\r\nDuring the reading, I have stumbled upon this post: [`zig cc`: a Powerful Drop-In Replacement for GCC/Clang](https://andrewkelley.me/post/zig-cc-powerful-drop-in-replacement-gcc-clang.html) by the Zig programming language author/designer. It turns out that a distribution of Zig includes a clang-based C compiler that can be invoked as `zig cc`, accepting clang options as it's essentially a wrapper for clang. However, unlike your typical clang, Zig bundles Linux kernel headers, and binaries and headers of: glibc, musl and mingw-w64, for many different architectures: aarch64, arm, i386, mips, powerpc, riscv, x86_64, etc., and it does so for many different versions of glibc and musl libc. This allows `zig cc` to easily cross-compile any C project to one of numerous ABIs it supports (over 40), for example `riscv64-linux-musl`, `aarch64-windows-gnu` or `x86_64-windows-gnu`, as well as target a specific versions of the libc, like `x86_64-linux-gnu.2.25` for glibc 2.25. So using `zig cc` saves a lot of trouble of downloading/building separate cross-compilers for every ABI, having the Linux headers, glibc, musl libc, mingw-w64, etc. for the ABI you want to target installed, etc. -- all you need is just to download zig, run `zig cc foo.c -o foo.exe --target x86_64-windows-gnu` and you get your C code cross-compiled to Windows without having anything extra installed besides zig as zig is fully statically compiled and includes everything needed for the cross-compilation. You can even run it on Windows to create Linux binaries. It also works with C++ code via `zig c++`. It's pretty much a portable cross-compiler for C/C++ code, and it's also very light as it does some clever deduplication to reduce all the Linux headers, glibc, musl libc and mingw-w64, (and Zig itself also ships mostly as source code that is compiled and cached at runtime), to the point that its tarball takes 45 MiB according to the post.\r\n\r\nSo Zig is great for cross-compiling C/C++ code. One can use the Zig clang-based compiler by setting `CC=\"zig cc -target foo-bar-abi\"` `CXX=\"zig c++ -target foo-bar-abi\"` and invoking the existing autotools/bazel/cmake build system. If the project has dependencies, and toxcore does: sodium, opus, vpx, config, cmp -- those, and all of their dependencies, also need to be cross-compiled the same way, i.e. using the Zig C compiler (this is not specific to Zig, that's just how cross-compiling works).\r\n\r\n---\r\n</details>\r\n\r\nWhile the Zig C compiler is a neat feature of Zig, using it doesn't necessitate the addition of `build.zig`, i.e. it doesn't require one to use the Zig build system in any way, it works just fine with the existing build systems toxcore uses. The only reasons to add a `build.zig` to a C project that I see are:\r\n\r\n1. If you simply want to use the Zig build system to build your C project (perhaps that's your only build system instead of the 4th? :D)\r\n2. If you want other projects using the Zig build system, be it C, C++ or Zig-native projects, to be able to easily add your project as a dependency to their Zig build system. ([Since many C/C++ projects don't provide a `build.zig`, developers using the Zig build system for their project with C/C++ dependencies tend to maintain forks of those C/C++ dependencies, e.g. ffmpeg, harfbuzz, freetype, etc. with `build.zig` added as the build system](https://devlog.hexops.com/2023/mach-ecosystem-c-libraries/)).\r\n\r\nSo this PR -- the addition of the Zig build system -- doesn't provide any benefits to toxcore over the existing autotools/bazel/cmake, this PR is more about providing benefits to the downstream projects that use the Zig build system and want to use toxcore. Also, this PR links only against sodium, cmp, pthreads and gtest, it doesn't link against opus, vpx and config, so it builds only the base toxcore library, not toxav or tox-bootrstrap, so there is more work that needs to be done to build the toxcore project in its entirety using the Zig build system. What is more, opus, vpx and config don't provide `build.zig`, so we would either have to write our own Zig build systems for those, or use someone else's if someone else has already done the work of writing `build.zig`, i.e. instead of pulling the project from https://github.com/xiph/opus, we would be pulling it from some fork https://github.com/some-random-person/opus-zigbuild, which would obviously need to be audited and pinned to the audited version, and every time we version bump the dependency, it would need to be re-audited again... In fact, this PR already does this with winpthreads and gtest -- it builds them from the forks https://github.com/kassane/winpthreads-zigbuild and https://github.com/nodecum/gtest-zig instead of the original trusted repositories/sources. (I wonder if those were audited?)\r\n\r\nAccepting this PR would result in a lot of work of getting the rest of toxcore dependencies Zig-ified, and then continuously making sure that our `build.zig` of those dependencies match what the upstream's build system does, or continuously auditing someone else's `build.zig` and the accompanied patched source code (I noticed winpthreads-zigbuild not only adds the `build.zig` but also patches the source code...). If you (@freylax) would be maintaining this `build.zig` in the [zig-toxcore-c](https://github.com/TokTok/zig-toxcore-c) anyway, I can see why you would want to have it reside in this repository instead, but this dependency stuff is just a bit too crazy.\r\n\r\nIf some Tox/TokTok developer is willing to take the responsibility for maintaining it, and do it properly -- actually audit the`buid.zig` forks used for dependencies as they are a lot less trusted than the original projects, then I guess fine. In the worst case we could just remove it if it gets unmaintained. But personally I'm not very thrilled about this PR.",
            "created_at": "2024-01-13T14:03:22Z",
            "html_url": "https://github.com/TokTok/c-toxcore/pull/2548#issuecomment-1890466778",
            "id": 1890466778,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2548",
            "node_id": "IC_kwDOA7zIGs5wrjva",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1890466778/reactions"
            },
            "updated_at": "2024-01-13T14:39:28Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1890466778",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1855294?v=4",
                "events_url": "https://api.github.com/users/nurupo/events{/privacy}",
                "followers_url": "https://api.github.com/users/nurupo/followers",
                "following_url": "https://api.github.com/users/nurupo/following{/other_user}",
                "gists_url": "https://api.github.com/users/nurupo/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/nurupo",
                "id": 1855294,
                "login": "nurupo",
                "node_id": "MDQ6VXNlcjE4NTUyOTQ=",
                "organizations_url": "https://api.github.com/users/nurupo/orgs",
                "received_events_url": "https://api.github.com/users/nurupo/received_events",
                "repos_url": "https://api.github.com/users/nurupo/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/nurupo/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/nurupo/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/nurupo",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "@nurupo I actually agree with you despite my thumbs-up. We just got rid of autotools because of how cumbersome maintaining 3 build systems was. I don't really see how this benefits the project at the moment. And in the case of autotools, we initially had a good reason to use it, which was vanilla nacl builds. Since vanilla nacl is dead and doesn't support a lot of our newer features, we no longer need it.",
            "created_at": "2024-01-13T15:13:48Z",
            "html_url": "https://github.com/TokTok/c-toxcore/pull/2548#issuecomment-1890484040",
            "id": 1890484040,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2548",
            "node_id": "IC_kwDOA7zIGs5wrn9I",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1890484040/reactions"
            },
            "updated_at": "2024-01-13T15:16:02Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1890484040",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/1646057?v=4",
                "events_url": "https://api.github.com/users/JFreegman/events{/privacy}",
                "followers_url": "https://api.github.com/users/JFreegman/followers",
                "following_url": "https://api.github.com/users/JFreegman/following{/other_user}",
                "gists_url": "https://api.github.com/users/JFreegman/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/JFreegman",
                "id": 1646057,
                "login": "JFreegman",
                "node_id": "MDQ6VXNlcjE2NDYwNTc=",
                "organizations_url": "https://api.github.com/users/JFreegman/orgs",
                "received_events_url": "https://api.github.com/users/JFreegman/received_events",
                "repos_url": "https://api.github.com/users/JFreegman/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/JFreegman/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/JFreegman/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/JFreegman",
                "user_view_type": "public"
            }
        },
        {
            "author_association": "MEMBER",
            "body": "Thanks @nurupo for your careful analysis. I do understand the concerns you have. In fact it is not necessary to have the build.zig  in the c-toxcore repo. Like I did for gtest one can have c-toxcore as dependency in a separate repository. Also linking c-toxcore directly could be possible, but then maybe loosing the seamless cross compilation properties. The motivation of this PR was to move the dependency from zig-toxcore-c to TokTok.  ",
            "created_at": "2024-01-13T16:36:54Z",
            "html_url": "https://github.com/TokTok/c-toxcore/pull/2548#issuecomment-1890587513",
            "id": 1890587513,
            "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2548",
            "node_id": "IC_kwDOA7zIGs5wsBN5",
            "performed_via_github_app": null,
            "reactions": {
                "+1": 0,
                "-1": 0,
                "confused": 0,
                "eyes": 0,
                "heart": 0,
                "hooray": 0,
                "laugh": 0,
                "rocket": 0,
                "total_count": 0,
                "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1890587513/reactions"
            },
            "updated_at": "2024-01-13T16:36:54Z",
            "url": "https://api.github.com/repos/TokTok/c-toxcore/issues/comments/1890587513",
            "user": {
                "avatar_url": "https://avatars.githubusercontent.com/u/6729524?v=4",
                "events_url": "https://api.github.com/users/freylax/events{/privacy}",
                "followers_url": "https://api.github.com/users/freylax/followers",
                "following_url": "https://api.github.com/users/freylax/following{/other_user}",
                "gists_url": "https://api.github.com/users/freylax/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/freylax",
                "id": 6729524,
                "login": "freylax",
                "node_id": "MDQ6VXNlcjY3Mjk1MjQ=",
                "organizations_url": "https://api.github.com/users/freylax/orgs",
                "received_events_url": "https://api.github.com/users/freylax/received_events",
                "repos_url": "https://api.github.com/users/freylax/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/freylax/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/freylax/subscriptions",
                "type": "User",
                "url": "https://api.github.com/users/freylax",
                "user_view_type": "public"
            }
        }
    ],
    "comments": 8,
    "comments_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2548/comments",
    "commit_data": [],
    "commits": 0,
    "commits_url": "https://api.github.com/repos/TokTok/c-toxcore/pulls/2548/commits",
    "created_at": "2024-01-11T15:35:49Z",
    "deletions": 0,
    "diff_url": "https://github.com/TokTok/c-toxcore/pull/2548.diff",
    "draft": false,
    "head": {
        "label": "nodecum:zig-build",
        "ref": "zig-build",
        "repo": {
            "allow_forking": true,
            "archive_url": "https://api.github.com/repos/nodecum/c-toxcore/{archive_format}{/ref}",
            "archived": false,
            "assignees_url": "https://api.github.com/repos/nodecum/c-toxcore/assignees{/user}",
            "blobs_url": "https://api.github.com/repos/nodecum/c-toxcore/git/blobs{/sha}",
            "branches_url": "https://api.github.com/repos/nodecum/c-toxcore/branches{/branch}",
            "clone_url": "https://github.com/nodecum/c-toxcore.git",
            "collaborators_url": "https://api.github.com/repos/nodecum/c-toxcore/collaborators{/collaborator}",
            "comments_url": "https://api.github.com/repos/nodecum/c-toxcore/comments{/number}",
            "commits_url": "https://api.github.com/repos/nodecum/c-toxcore/commits{/sha}",
            "compare_url": "https://api.github.com/repos/nodecum/c-toxcore/compare/{base}...{head}",
            "contents_url": "https://api.github.com/repos/nodecum/c-toxcore/contents/{+path}",
            "contributors_url": "https://api.github.com/repos/nodecum/c-toxcore/contributors",
            "created_at": "2023-10-21T21:52:20Z",
            "default_branch": "master",
            "deployments_url": "https://api.github.com/repos/nodecum/c-toxcore/deployments",
            "description": "The future of online communications.",
            "disabled": false,
            "downloads_url": "https://api.github.com/repos/nodecum/c-toxcore/downloads",
            "events_url": "https://api.github.com/repos/nodecum/c-toxcore/events",
            "fork": true,
            "forks": 0,
            "forks_count": 0,
            "forks_url": "https://api.github.com/repos/nodecum/c-toxcore/forks",
            "full_name": "nodecum/c-toxcore",
            "git_commits_url": "https://api.github.com/repos/nodecum/c-toxcore/git/commits{/sha}",
            "git_refs_url": "https://api.github.com/repos/nodecum/c-toxcore/git/refs{/sha}",
            "git_tags_url": "https://api.github.com/repos/nodecum/c-toxcore/git/tags{/sha}",
            "git_url": "git://github.com/nodecum/c-toxcore.git",
            "has_discussions": false,
            "has_downloads": true,
            "has_issues": false,
            "has_pages": false,
            "has_projects": true,
            "has_wiki": false,
            "homepage": "https://tox.chat/",
            "hooks_url": "https://api.github.com/repos/nodecum/c-toxcore/hooks",
            "html_url": "https://github.com/nodecum/c-toxcore",
            "id": 708216584,
            "is_template": false,
            "issue_comment_url": "https://api.github.com/repos/nodecum/c-toxcore/issues/comments{/number}",
            "issue_events_url": "https://api.github.com/repos/nodecum/c-toxcore/issues/events{/number}",
            "issues_url": "https://api.github.com/repos/nodecum/c-toxcore/issues{/number}",
            "keys_url": "https://api.github.com/repos/nodecum/c-toxcore/keys{/key_id}",
            "labels_url": "https://api.github.com/repos/nodecum/c-toxcore/labels{/name}",
            "language": "C",
            "languages_url": "https://api.github.com/repos/nodecum/c-toxcore/languages",
            "license": {
                "key": "gpl-3.0",
                "name": "GNU General Public License v3.0",
                "node_id": "MDc6TGljZW5zZTk=",
                "spdx_id": "GPL-3.0",
                "url": "https://api.github.com/licenses/gpl-3.0"
            },
            "merges_url": "https://api.github.com/repos/nodecum/c-toxcore/merges",
            "milestones_url": "https://api.github.com/repos/nodecum/c-toxcore/milestones{/number}",
            "mirror_url": null,
            "name": "c-toxcore",
            "node_id": "R_kgDOKjaHCA",
            "notifications_url": "https://api.github.com/repos/nodecum/c-toxcore/notifications{?since,all,participating}",
            "open_issues": 0,
            "open_issues_count": 0,
            "owner": {
                "avatar_url": "https://avatars.githubusercontent.com/u/92477136?v=4",
                "events_url": "https://api.github.com/users/nodecum/events{/privacy}",
                "followers_url": "https://api.github.com/users/nodecum/followers",
                "following_url": "https://api.github.com/users/nodecum/following{/other_user}",
                "gists_url": "https://api.github.com/users/nodecum/gists{/gist_id}",
                "gravatar_id": "",
                "html_url": "https://github.com/nodecum",
                "id": 92477136,
                "login": "nodecum",
                "node_id": "O_kgDOBYMW0A",
                "organizations_url": "https://api.github.com/users/nodecum/orgs",
                "received_events_url": "https://api.github.com/users/nodecum/received_events",
                "repos_url": "https://api.github.com/users/nodecum/repos",
                "site_admin": false,
                "starred_url": "https://api.github.com/users/nodecum/starred{/owner}{/repo}",
                "subscriptions_url": "https://api.github.com/users/nodecum/subscriptions",
                "type": "Organization",
                "url": "https://api.github.com/users/nodecum",
                "user_view_type": "public"
            },
            "private": false,
            "pulls_url": "https://api.github.com/repos/nodecum/c-toxcore/pulls{/number}",
            "pushed_at": "2024-01-18T21:02:14Z",
            "releases_url": "https://api.github.com/repos/nodecum/c-toxcore/releases{/id}",
            "size": 17848,
            "ssh_url": "git@github.com:nodecum/c-toxcore.git",
            "stargazers_count": 0,
            "stargazers_url": "https://api.github.com/repos/nodecum/c-toxcore/stargazers",
            "statuses_url": "https://api.github.com/repos/nodecum/c-toxcore/statuses/{sha}",
            "subscribers_url": "https://api.github.com/repos/nodecum/c-toxcore/subscribers",
            "subscription_url": "https://api.github.com/repos/nodecum/c-toxcore/subscription",
            "svn_url": "https://github.com/nodecum/c-toxcore",
            "tags_url": "https://api.github.com/repos/nodecum/c-toxcore/tags",
            "teams_url": "https://api.github.com/repos/nodecum/c-toxcore/teams",
            "topics": [],
            "trees_url": "https://api.github.com/repos/nodecum/c-toxcore/git/trees{/sha}",
            "updated_at": "2023-12-14T22:10:24Z",
            "url": "https://api.github.com/repos/nodecum/c-toxcore",
            "visibility": "public",
            "watchers": 0,
            "watchers_count": 0,
            "web_commit_signoff_required": false
        },
        "sha": "bcb6592af5496f17417f71924fbf0bcbbd03fe06",
        "user": {
            "avatar_url": "https://avatars.githubusercontent.com/u/92477136?v=4",
            "events_url": "https://api.github.com/users/nodecum/events{/privacy}",
            "followers_url": "https://api.github.com/users/nodecum/followers",
            "following_url": "https://api.github.com/users/nodecum/following{/other_user}",
            "gists_url": "https://api.github.com/users/nodecum/gists{/gist_id}",
            "gravatar_id": "",
            "html_url": "https://github.com/nodecum",
            "id": 92477136,
            "login": "nodecum",
            "node_id": "O_kgDOBYMW0A",
            "organizations_url": "https://api.github.com/users/nodecum/orgs",
            "received_events_url": "https://api.github.com/users/nodecum/received_events",
            "repos_url": "https://api.github.com/users/nodecum/repos",
            "site_admin": false,
            "starred_url": "https://api.github.com/users/nodecum/starred{/owner}{/repo}",
            "subscriptions_url": "https://api.github.com/users/nodecum/subscriptions",
            "type": "Organization",
            "url": "https://api.github.com/users/nodecum",
            "user_view_type": "public"
        }
    },
    "html_url": "https://github.com/TokTok/c-toxcore/pull/2548",
    "id": 1674791463,
    "issue_url": "https://api.github.com/repos/TokTok/c-toxcore/issues/2548",
    "labels": [],
    "locked": false,
    "maintainer_can_modify": false,
    "merge_commit_sha": "7d5efcb68faee4218fdb04fb3b459a7acc6fb921",
    "mergeable": null,
    "mergeable_state": "unknown",
    "merged": false,
    "merged_at": null,
    "merged_by": null,
    "milestone": null,
    "node_id": "PR_kwDOA7zIGs5j00on",
    "number": 2548,
    "patch_url": "https://github.com/TokTok/c-toxcore/pull/2548.patch",
    "rebaseable": null,
    "requested_reviewers": [],
    "requested_teams": [],
    "review_comment_url": "https://api.github.com/repos/TokTok/c-toxcore/pulls/comments{/number}",
    "review_comments": 2,
    "review_comments_url": "https://api.github.com/repos/TokTok/c-toxcore/pulls/2548/comments",
    "state": "closed",
    "statuses_url": "https://api.github.com/repos/TokTok/c-toxcore/statuses/bcb6592af5496f17417f71924fbf0bcbbd03fe06",
    "title": "feat: build c-toxcore with the zig build system",
    "updated_at": "2024-01-13T22:12:39Z",
    "url": "https://api.github.com/repos/TokTok/c-toxcore/pulls/2548",
    "user": {
        "avatar_url": "https://avatars.githubusercontent.com/u/6729524?v=4",
        "events_url": "https://api.github.com/users/freylax/events{/privacy}",
        "followers_url": "https://api.github.com/users/freylax/followers",
        "following_url": "https://api.github.com/users/freylax/following{/other_user}",
        "gists_url": "https://api.github.com/users/freylax/gists{/gist_id}",
        "gravatar_id": "",
        "html_url": "https://github.com/freylax",
        "id": 6729524,
        "login": "freylax",
        "node_id": "MDQ6VXNlcjY3Mjk1MjQ=",
        "organizations_url": "https://api.github.com/users/freylax/orgs",
        "received_events_url": "https://api.github.com/users/freylax/received_events",
        "repos_url": "https://api.github.com/users/freylax/repos",
        "site_admin": false,
        "starred_url": "https://api.github.com/users/freylax/starred{/owner}{/repo}",
        "subscriptions_url": "https://api.github.com/users/freylax/subscriptions",
        "type": "User",
        "url": "https://api.github.com/users/freylax",
        "user_view_type": "public"
    }
}